var Pomodoro=(function(){var b={pomodoro:{running:false,duration:25},short_pause:{running:false,duration:5,},long_pause:{running:false,duration:10,}};var c={tick:{value:false,id:"tick",},ring:{value:true,id:"ring",},};var f=new Audio("sound/tick.wav");var d=new Audio("sound/ring.wav");var h=null;function a(o){var m=new Date,n=false,p=null;function l(r,q){$("#b").width((r*100/q)+"%")}function k(r,q,s){$("#"+s).text((r<10?"0":"")+r)}o.running=true;(function(){var q=new Date;done=new Date(q-m),second_counter=59-done.getSeconds(),minute_counter=o.duration-1-done.getMinutes();if(minute_counter<0){if(c.ring.value===true){d.play()}h();h=null;return}l(done.getTime()/1000,60*o.duration);k(second_counter,60,"s");k(minute_counter,o.duration,"m");document.title=$("#time").text();if(c.tick.value===true){f.play()}p=setTimeout(arguments.callee,1000);init=false})();return function(){clearTimeout(p);init=true;o.running=false;l(0,60*o.duration);j();$("#s").html("--");$("#m").html("--");document.title=$("#time").text()}}function i(m,l){var o=b[l];var k=b[l].running===true;if(h!==null){h();h=null;if(k){return}}var n=m.html();n=n.replace("Start","Stop");m.removeClass("btn-primary");m.addClass("btn-warning");m.html(n);h=a(b[l])}function j(){var k=$("button.link");k.removeClass();k.addClass("link");k.addClass("btn");k.addClass("btn-large");k.addClass("btn-primary");$("#start_pomodoro").html("Start pomodoro");$("#start_short").html("Start short pause");$("#start_long").html("Start long pause")}function e(){c.tick.value=$("input#"+c.tick.id).prop("checked");c.ring.value=$("input#"+c.ring.id).prop("checked")}function g(){$(document).ready(function(){$(document).keydown(function(k){if(k.which==80){$("#start_pomodoro").click()}else{if(k.which==83){$("#start_short").click()}else{if(k.which==76){$("#start_long").click()}}}});$("input#"+c.tick.id).prop("checked",c.tick.value);$("input#"+c.ring.id).prop("checked",c.ring.value)})}return{init:g,refresh_settings:e,toggle_activity:i}}());